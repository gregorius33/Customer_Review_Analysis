---
name: 리뷰 열 자동 인식 설계
overview: "리뷰 내용 열이 항상 같은 열에 있지 않을 수 있는 문제를 해결하기 위한 처리 전략 (단계적 폴백)."
todos: []
isProject: false
---

# 리뷰 내용 열(컬럼) 처리 전략

## 문제 정리

- 엑셀 구조: **고객ID, 이름, 구매한 노트북 모델, 평점, 리뷰내용** (현재 파일은 리뷰가 E열).
- 다른 파일에서는 컬럼 순서가 바뀌거나 시트 레이아웃이 달라질 수 있어, **리뷰 내용이 항상 같은 열에 있다고 가정할 수 없음**.

---

## 권장: 단계적 폴백(1 → 2)

1. **1단계: 헤더 이름 매칭** — 정의된 별칭 목록으로 열 검색 (대소문자/공백 무시).
2. **2단계: 못 찾았을 때 사용자 선택** — GUI에서 컬럼 목록을 드롭다운으로 보여 주고 사용자가 선택.

---

## 구현

- config.py에 역할별 헤더 후보 목록: review, rating, product, customer_id, name, **age**, **purchase_date**, **gender**.
- excel_loader.resolve_columns(df)로 자동 매칭, None인 역할은 GUI 콤보박스로 선택.
- 보고서에 연령대·성별·구매일자 분포는 해당 열이 매핑된 경우에만 포함.
