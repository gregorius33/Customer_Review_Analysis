---
name: 리뷰 열 자동 인식 설계
overview: "사용자가 지정한 엑셀 파일을 읽어 리뷰 분석 보고서를 만드는 프로그램에서, \"리뷰 내용\" 열이 항상 같은 열(예: E열)에 있지 않을 수 있는 문제를 해결하기 위한 처리 전략을 정리합니다."
todos: []
isProject: false
---

# 리뷰 내용 열(컬럼) 처리 전략

## 문제 정리

- 엑셀 구조: **고객ID, 이름, 구매한 노트북 모델, 평점, 리뷰내용** (현재 파일은 리뷰가 E열).
- 다른 파일에서는 컬럼 순서가 바뀌거나 시트 레이아웃이 달라질 수 있어, **리뷰 내용이 항상 같은 열에 있다고 가정할 수 없음**.
- 같은 맥락으로 평점·모델명 등도 열 위치가 달라질 수 있음.

---

## 처리 방안 비교


| 방안                 | 설명                                                            | 장점                | 단점                       |
| ------------------ | ------------------------------------------------------------- | ----------------- | ------------------------ |
| **1. 헤더 이름으로 매칭**  | 첫 행을 헤더로 읽고, "리뷰내용", "리뷰 내용", "Review" 등 **정의된 이름 목록**으로 열 검색 | 열 순서에 무관, 재사용 가능  | 헤더 이름이 다르면 실패 (별칭 목록 필요) |
| **2. 실행 시 사용자 지정** | 파일 로드 후 컬럼 목록을 보여주고 "리뷰 내용 열"을 **사용자가 선택**                    | 어떤 레이아웃이든 대응 가능   | 매번 선택 필요, 자동화·배치에 불리     |
| **3. 설정 파일/매핑**    | JSON 등에 `{"리뷰": "E", "평점": "D"}` 형태로 **파일별 또는 템플릿별 매핑** 저장    | 같은 형식 파일 재사용 시 빠름 | 형식이 바뀌면 매핑 수정 필요         |
| **4. 휴리스틱 자동 감지**  | 텍스트 길이·형태 등으로 "가장 리뷰 같아 보이는 열" 추정 (예: 평균 길이 가장 긴 문자열 열)       | 헤더가 없어도 시도 가능     | 오탐 가능, 다른 긴 텍스트 열과 혼동    |


---

## 권장: 단계적 폴백(1 → 2 → 3)

**우선순위를 두고 순서대로 시도**하는 방식이 가장 무난합니다.

```mermaid
flowchart LR
  A[엑셀 로드] --> B[헤더 이름으로 리뷰 열 찾기]
  B -->|찾음| C[해당 열 사용]
  B -->|못 찾음| D[사용자에게 열 선택 요청]
  D --> C
  C --> E[분석 실행]
```



1. **1단계: 헤더 이름 매칭 (기본)**
  - 첫 행을 컬럼명으로 읽고, **리뷰 열 후보 이름 목록**과 비교 (대소문자 무시, 공백/붙여쓰기 모두 허용).  
  - 예: `["리뷰내용", "리뷰 내용", "Review", "review_content", "리뷰"]`  
  - 동일하게 **평점**, **노트북 모델**, **고객ID**, **이름** 등도 후보 이름 목록을 두고 매칭하면, 열 순서가 바뀌어도 나머지 분석 로직을 그대로 쓸 수 있음.
2. **2단계: 못 찾았을 때 사용자 선택**
  - 매칭되는 헤더가 없으면, **컬럼 목록(헤더 또는 A, B, C…)을 보여주고** "리뷰 내용에 해당하는 열을 선택해 주세요" 같이 안내.  
  - GUI라면 드롭다운/라디오, CLI라면 번호 또는 컬럼명 입력으로 선택.
3. **3단계(선택): 매핑 저장**
  - 사용자가 선택한 결과를 **"이 파일명/시트명일 때는 이 열"** 형태로 설정 파일에 저장해 두고, 다음에 같은 파일을 열면 자동 적용. 새 형식의 파일이 올 때만 다시 선택.

---

## 구현 시 유의사항

- **시트 선택**: 시트가 여러 개면 "첫 시트 사용" 또는 "시트 목록에서 선택" 규칙을 하나 정해 두는 것이 좋음.
- **헤더 행 위치**: 일부 엑셀은 1행이 제목/빈 칸이고 2행이 헤더일 수 있음. 필요하면 `header=1` 옵션 또는 "헤더가 있는 행 번호"를 지정할 수 있게 두면 유연해짐.
- **평점/모델 등**: 리뷰 내용만이 아니라 평점·모델명도 열이 바뀔 수 있으므로, **공통 "컬럼 매핑" 모듈**을 두고 "리뷰", "평점", "모델" 등 역할별로 열을 찾는 함수 하나로 묶으면 코드 중복을 줄일 수 있음.

---

## 요약

- **리뷰 열이 고정이 아닐 때**: **헤더 이름 매칭(정의된 별칭 목록)** 을 기본으로 하고, **매칭 실패 시 사용자가 열을 선택**하도록 하면, 열 위치가 달라도 안정적으로 동작합니다.
- 선택적으로 **파일/시트별 매핑 저장**을 넣으면, 같은 형식 파일을 반복 분석할 때 편해집니다.
- 평점·모델 등 다른 필드도 같은 방식으로 "역할별 열 찾기"를 적용하면, 전체 프로그램이 다양한 엑셀 레이아웃에 대응하기 쉬워집니다.

